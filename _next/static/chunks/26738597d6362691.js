(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78928,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),r=e.i(39544),i=e.i(39312),n=e.i(64030),l=e.i(75254);let c=(0,l.default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),d=(0,l.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var o=e.i(74323),m=e.i(42009),x=e.i(61911),u=e.i(41240);let h=(0,l.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var p=e.i(42920),y=e.i(94351),g=e.i(63209),b=e.i(61659);let j=(0,l.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var v=e.i(83086);let _=(0,l.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var f=e.i(27516),N=e.i(25652),w=e.i(17923),k=e.i(16715);let S=(0,l.default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var A=e.i(17927),z=e.i(28362);function M(){let e=(0,a.useRouter)(),[l,M]=(0,s.useState)(null),[T,P]=(0,s.useState)(!0),[$,E]=(0,s.useState)(!1),[D,C]=(0,s.useState)([]),[B,I]=(0,s.useState)(null),[K,R]=(0,s.useState)([]),[O,F]=(0,s.useState)(null),[L,W]=(0,s.useState)(null),[H,q]=(0,s.useState)({subscription_id:"",counter_value:""}),[Y,G]=(0,s.useState)([]),[J,U]=(0,s.useState)([]),[Z,V]=(0,s.useState)([]),[Q,X]=(0,s.useState)(null),[ee,et]=(0,s.useState)(null),[es,ea]=(0,s.useState)({waterSavingsPercent:0,electricitySavingsPercent:0,waterSavedAmount:0,electricitySavedAmount:0,monthlyPoints:0,totalPoints:0,lastMonthPoints:0,buildingRank:0,monthlyRank:0,totalInBuilding:0,currentMonthWater:0,currentMonthElectricity:0,previousMonthWater:0,previousMonthElectricity:0,comparedToAvg:"veri yetersiz",currentMonthName:"",previousMonthName:""}),er=()=>{let e=new Date;return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}`},ei=e=>{let[t,s]=e.split("-").map(Number);return`${["Ocak","≈ûubat","Mart","Nisan","Mayƒ±s","Haziran","Temmuz","Aƒüustos","Eyl√ºl","Ekim","Kasƒ±m","Aralƒ±k"][s-1]} ${t}`},en=e=>({ƒ∞SKƒ∞:[{min_points:0,discount_percent:0,tier_name:"Ba≈ülangƒ±√ß"},{min_points:50,discount_percent:2,tier_name:"Tasarruf√ßu"},{min_points:120,discount_percent:5,tier_name:"Su Dostu"},{min_points:250,discount_percent:8,tier_name:"Eko El√ßisi"},{min_points:500,discount_percent:12,tier_name:"Su Kahramanƒ±"}],Aydem:[{min_points:0,discount_percent:0,tier_name:"Ba≈ülangƒ±√ß"},{min_points:40,discount_percent:1,tier_name:"Tasarruf√ßu"},{min_points:100,discount_percent:3,tier_name:"Enerji Dostu"},{min_points:200,discount_percent:6,tier_name:"Eko Champion"},{min_points:400,discount_percent:10,tier_name:"Enerji Lideri"}],Enerjisa:[{min_points:0,discount_percent:0,tier_name:"Ba≈ülangƒ±√ß"},{min_points:60,discount_percent:2,tier_name:"Tasarruf√ßu"},{min_points:150,discount_percent:5,tier_name:"Eko G√∂n√ºll√º"},{min_points:300,discount_percent:9,tier_name:"Eko Lider"},{min_points:600,discount_percent:14,tier_name:"Eko Visioner"}],TESKƒ∞:[{min_points:0,discount_percent:0,tier_name:"Ba≈ülangƒ±√ß"},{min_points:80,discount_percent:3,tier_name:"Tasarruf√ßu"},{min_points:200,discount_percent:6,tier_name:"Su Koruyucusu"},{min_points:400,discount_percent:10,tier_name:"Eko Champion"},{min_points:800,discount_percent:15,tier_name:"Su El√ßisi"}]})[e]||[{min_points:0,discount_percent:0,tier_name:"Ba≈ülangƒ±√ß"},{min_points:100,discount_percent:3,tier_name:"Tasarruf√ßu"},{min_points:300,discount_percent:6,tier_name:"√áevre Dostu"},{min_points:600,discount_percent:10,tier_name:"Eko G√∂n√ºll√º"},{min_points:1e3,discount_percent:15,tier_name:"Eko Lider"}],el=(e,t)=>{let s={};[...e].sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()).forEach(e=>{let a=new Date(e.created_at),r=`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}`;s[r]||(s[r]={});let i=t.find(t=>t.id===e.subscription_id);i&&(s[r][e.subscription_id]||(s[r][e.subscription_id]={water:0,electricity:0}),"water"===i.utility_type?s[r][e.subscription_id].water=e.water_amount||0:s[r][e.subscription_id].electricity=e.electricity_amount||0)});let a=Object.keys(s).sort((e,t)=>t.localeCompare(e));if(a.length<2){let e=a[0]||er(),[t,s]=e.split("-").map(Number);return{currentMonth:e,previousMonth:1===s?`${t-1}-12`:`${t}-${(s-1).toString().padStart(2,"0")}`,currentWater:0,previousWater:0,currentElectricity:0,previousElectricity:0,waterSavingsPercent:0,electricitySavingsPercent:0,waterSavedAmount:0,electricitySavedAmount:0}}let r=a[0],i=a[1],n=0,l=0,c=0,d=0;Object.keys(s[r]||{}).forEach(e=>{let a=t.find(t=>t.id===parseInt(e));if(a?.utility_type==="water"){let t=s[r][parseInt(e)].water,a=s[i]?.[parseInt(e)]?.water||0;a>0&&(n+=t-a)}}),Object.keys(s[i]||{}).forEach(e=>{let r=t.find(t=>t.id===parseInt(e));if(r?.utility_type==="water"){let t=s[i][parseInt(e)].water,r=a[2]&&s[a[2]]?.[parseInt(e)]?.water||0;r>0&&(l+=t-r)}}),Object.keys(s[r]||{}).forEach(e=>{let a=t.find(t=>t.id===parseInt(e));if(a?.utility_type==="electricity"){let t=s[r][parseInt(e)].electricity,a=s[i]?.[parseInt(e)]?.electricity||0;a>0&&(c+=t-a)}}),Object.keys(s[i]||{}).forEach(e=>{let r=t.find(t=>t.id===parseInt(e));if(r?.utility_type==="electricity"){let t=s[i][parseInt(e)].electricity,r=a[2]&&s[a[2]]?.[parseInt(e)]?.electricity||0;r>0&&(d+=t-r)}});let o=0,m=0,x=0,u=0;return l>0&&n>0&&(o=(x=l-n)/l*100),d>0&&c>0&&(m=(u=d-c)/d*100),{currentMonth:r,previousMonth:i,currentWater:Math.round(100*n)/100,previousWater:Math.round(100*l)/100,currentElectricity:Math.round(100*c)/100,previousElectricity:Math.round(100*d)/100,waterSavingsPercent:o=Math.max(-100,Math.min(80,Math.round(10*o)/10)),electricitySavingsPercent:m=Math.max(-100,Math.min(80,Math.round(10*m)/10)),waterSavedAmount:Math.round(100*x)/100,electricitySavedAmount:Math.round(100*u)/100}},ec=(e,t)=>{let s=0;e.waterSavingsPercent>0&&(s+=5*e.waterSavingsPercent),e.electricitySavingsPercent>0&&(s+=5*e.electricitySavingsPercent),e.waterSavingsPercent<0&&(s+=2*e.waterSavingsPercent),e.electricitySavingsPercent<0&&(s+=2*e.electricitySavingsPercent);let a=e.currentMonth;s+=3*t.filter(e=>{let t=new Date(e.created_at);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}`===a}).length;let r=[...t].sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()),i=0;for(let e=0;e<Math.min(r.length-1,3);e++){let t=new Date(r[e].created_at),s=new Date(r[e+1].created_at);if(35>=Math.floor((t.getTime()-s.getTime())/864e5))i++;else break}return Math.max(0,Math.round(s+=5*i))},ed=async e=>{try{let t=D.find(t=>t.id===e);if(!t)return;let s=t.utility_type,{data:a,error:r}=await A.supabase.from("consumptions").select("*").eq("subscription_id",e).order("created_at",{ascending:!1}).limit(1);if(r)return void console.error("Son kayƒ±t √ßekme hatasƒ±:",r);if(a&&a.length>0){let e=a[0],t="water"===s?e.water_amount:e.electricity_amount;null!=t?(F(Number(t)),W(new Date(e.created_at).toLocaleDateString("tr-TR"))):(F(null),W(null))}else F(null),W(null)}catch(e){console.error("Son saya√ß deƒüeri alƒ±namadƒ±:",e),F(null),W(null)}},eo=async e=>{try{let{data:t}=await A.supabase.from("user_applied_tips").select("tip_id").eq("user_id",e),s=t?.map(e=>e.tip_id)||[],{data:a}=await A.supabase.from("tips").select("*").is("user_id",null).not("id","in",`(${s.join(",")||"0"})`).limit(5);if(a){let e=a.map(e=>({id:e.id,title:e.title||"Tasarruf √ñnerisi",content:e.content||e.tip_text||"",category:e.category||"general",estimated_savings:e.estimated_savings||5,difficulty:e.difficulty||"medium",utility_type:e.utility_type||"general",points_reward:e.points_reward||("easy"===e.difficulty?8:"medium"===e.difficulty?12:15)}));G(e)}}catch(e){console.error("√ñneriler y√ºklenemedi:",e)}},em=async e=>{try{let t=e.apartment?.building?.id;if(!t)return;let{data:s}=await A.supabase.from("users").select(`
          id,
          name,
          total_points,
          monthly_points,
          apartment_id,
          apartments (
            number,
            building_id
          )
        `).eq("apartments.building_id",t).order("monthly_points",{ascending:!1});if(s){let t=s.map((t,s)=>{let a=Array.isArray(t.apartments)?t.apartments:[t.apartments],r=a.length>0?a[0]:null;return{id:t.id,name:t.name||`Daire ${r?.number||"?"}`,apartment_number:r?.number||"?",total_points:t.total_points||0,monthly_points:t.monthly_points||0,rank:s+1,is_current_user:t.id===e.id}});U(t);let a=t.findIndex(t=>t.id===e.id)+1;ea(s=>({...s,buildingRank:a||t.length+1,monthlyRank:t.find(t=>t.id===e.id)?.rank||0,totalInBuilding:t.length}))}}catch(e){console.error("Liderlik tablosu y√ºklenemedi:",e)}},ex=async(e,t,s)=>{let a=[],r=er();for(let e of t){let t=e.companies?.[0];if(!t)continue;let i=s.filter(t=>{if(t.subscription_id!==e.id)return!1;let s=new Date(t.created_at);return`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}`===r}),n=0;i.length>0&&(n=ec(el(i,[e]),i),t.is_contracted&&(n=Math.round(1.2*n)));let l=s.filter(t=>t.subscription_id===e.id).reduce((e,t)=>e+(t.monthly_points||0),0),c=[];try{Array.isArray(t.discount_tiers)?c=t.discount_tiers:"string"==typeof t.discount_tiers&&(c=JSON.parse(t.discount_tiers))}catch(e){console.warn(`Discount tiers parse hatasƒ± for ${t.name}:`,e)}c&&0!==c.length||(c=en(t.name));let d=0,o="Ba≈ülangƒ±√ß",m=0,x=0,u="",h=0;for(let e=c.length-1;e>=0;e--)if(n>=c[e].min_points){if(d=c[e].discount_percent,o=c[e].tier_name||`Seviye ${e+1}`,e<c.length-1){m=c[e+1].min_points-n,x=c[e+1].discount_percent,u=c[e+1].tier_name||`Seviye ${e+2}`;let t=c[e+1].min_points-c[e].min_points;h=Math.round((n-c[e].min_points)/t*100)}else h=100;break}0===d&&c.length>0&&(d=c[0].discount_percent,o=c[0].tier_name||"Ba≈ülangƒ±√ß",m=c[1]?.min_points-n||0,x=c[1]?.discount_percent||0,u=c[1]?.tier_name||"",h=Math.round(100*(n/c[1]?.min_points||1))),a.push({company_id:t.id,company_name:t.name,company_code:t.code,utility_type:e.utility_type,is_contracted:t.is_contracted||!1,monthly_points:n,total_points:l,current_discount:d,current_tier_name:o,next_tier_points:m,next_tier_discount:x,next_tier_name:u,progress_percent:h,discount_tiers:c})}return a},eu=async(e,t,s)=>{try{let{data:a,error:r}=await A.supabase.rpc("update_user_points_safe",{user_id_param:e,monthly_points_param:t,total_points_param:s});if(r){console.error("RPC hatasƒ±:",r);let{error:a}=await A.supabase.from("users").update({monthly_points:t,total_points:s,updated_at:new Date().toISOString()}).eq("id",e);if(a)throw Error(`Update failed: ${a.message}`);return{success:!0}}return a}catch(e){throw console.error("Puan g√ºncelleme hatasƒ±:",e),e}},eh=async e=>{try{let t=JSON.parse(localStorage.getItem("ekoakort_user")||"{}");if(t._cached&&t.id===e){console.log("üîÑ Cache'li puanlarƒ± sync ediyor...");let s=await eu(e,t.monthly_points,t.total_points);s?.success&&(delete t._cached,delete t._cached_at,localStorage.setItem("ekoakort_user",JSON.stringify(t)),console.log("‚úÖ Cache sync ba≈üarƒ±lƒ±"))}}catch(e){console.error("Sync hatasƒ±:",e)}},ep=async()=>{try{E(!0);let t=JSON.parse(localStorage.getItem("ekoakort_user")||"{}");if(!t.id)return void e.push("/login");console.log("üìä Dashboard verileri √ßekiliyor...");let{data:s,error:a}=await A.supabase.from("user_subscriptions").select(`
        id, 
        company_id, 
        subscriber_no, 
        utility_type, 
        is_active,
        created_at,
        companies!inner (
          id, 
          name, 
          code, 
          utility_type, 
          discount_tiers,
          is_contracted
        )
      `).eq("user_id",t.id).eq("is_active",!0).order("created_at",{ascending:!1});if(a)throw console.error("Abonelikler √ßekilemedi:",a),a;let r=(s||[]).map(e=>({id:e.id,company_id:e.company_id,subscriber_no:e.subscriber_no,utility_type:e.utility_type,is_active:e.is_active,created_at:e.created_at,companies:Array.isArray(e.companies)?e.companies:[e.companies]}));if(C(r),r.length>0){let e=r[0];I(e),q(t=>({...t,subscription_id:e.id.toString()}))}let i=[];if(r.length>0){let e=r.map(e=>e.id),{data:t,error:s}=await A.supabase.from("consumptions").select("*").in("subscription_id",e).order("created_at",{ascending:!1});s?console.error("T√ºketim verisi √ßekilemedi:",s):(i=t||[],console.log(`üìà ${i.length} t\xfcketim kaydƒ± bulundu`))}if(R(i),i.length>=1&&r.length>0){let e=el(i,r);X(e);let t=ec(e,i);ea(s=>{var a,r;let i;return{...s,waterSavingsPercent:e.waterSavingsPercent,electricitySavingsPercent:e.electricitySavingsPercent,waterSavedAmount:e.waterSavedAmount,electricitySavedAmount:e.electricitySavedAmount,currentMonthWater:e.currentWater,currentMonthElectricity:e.currentElectricity,previousMonthWater:e.previousWater,previousMonthElectricity:e.previousElectricity,monthlyPoints:t,currentMonthName:ei(e.currentMonth),previousMonthName:ei(e.previousMonth),comparedToAvg:(a=e.waterSavingsPercent,r=e.electricitySavingsPercent,i=(a+r)/2,0===a&&0===r?"veri yok":i>15?"s√ºper tasarruf! üèÜ":i>8?"harika gidiyorsun! ‚ú®":i>3?"iyi gidiyorsun üëç":i>0?"k√º√ß√ºk tasarruf ‚úì":i>-5?"neredeyse aynƒ± ‚ÜîÔ∏è":i>-10?"biraz fazla kullanmƒ±≈üsƒ±n ‚ö†Ô∏è":"dikkat! fazla kullanƒ±m var üî¥")}})}try{if(r.length>0&&i.length>0){let e=await ex(t,r,i);V(e);let s=e.reduce((e,t)=>e+t.total_points,0);ea(e=>({...e,totalPoints:s}))}}catch(e){console.error("Company discounts hesaplama hatasƒ±:",e)}try{await em(t)}catch(e){console.error("Liderlik verisi hatasƒ±:",e)}try{await eo(t.id)}catch(e){console.error("√ñneriler hatasƒ±:",e)}try{await eu(t.id,es.monthlyPoints,es.totalPoints)}catch(e){console.error("Puan g√ºncelleme hatasƒ±:",e)}}catch(e){console.error("Dashboard verisi y√ºklenemedi:",e)}finally{P(!1),E(!1)}},ey=async e=>{try{let t=JSON.parse(localStorage.getItem("ekoakort_user")||"{}"),s=t.monthly_tips_used||0;if(s>=3)return void alert("‚ùå Aylƒ±k √∂neri limitiniz doldu! Her ay en fazla 3 √∂neri uygulayabilirsiniz.");let{data:a}=await A.supabase.from("user_applied_tips").select("*").eq("user_id",t.id).eq("tip_id",e).single();if(a)return void alert("‚ö†Ô∏è Bu √∂neriyi zaten uygulamƒ±≈üsƒ±nƒ±z!");let{data:r}=await A.supabase.from("tips").select("*").eq("id",e).single();if(!r)return void alert("√ñneri bulunamadƒ±!");let i=s+1;await A.supabase.from("users").update({monthly_tips_used:i,last_tip_reset:new Date().toISOString().split("T")[0]}).eq("id",t.id);let n=r.points_reward||10;await A.supabase.from("user_applied_tips").insert([{user_id:t.id,tip_id:e,earned_points:n}]);let l=(es.totalPoints||0)+n;await A.supabase.from("users").update({total_points:l}).eq("id",t.id),localStorage.setItem("ekoakort_user",JSON.stringify({...t,monthly_tips_used:i,total_points:l})),ea(e=>({...e,totalPoints:l})),M(e=>({...e,monthly_tips_used:i,total_points:l})),G(t=>t.filter(t=>t.id!==e)),alert(`‚úÖ "${r.title}" \xf6nerisi uygulandƒ±!
üéâ ${n} puan kazandƒ±nƒ±z!
üìä Aylƒ±k kalan \xf6neri hakkƒ±nƒ±z: ${3-i}`),await eo(t.id)}catch(e){console.error("√ñneri uygulanamadƒ±:",e),alert("√ñneri uygulanƒ±rken bir hata olu≈ütu.")}},eg=async()=>{if(!H.subscription_id||!H.counter_value)return void alert("L√ºtfen abonelik se√ßin ve saya√ß deƒüerini girin");try{let e=JSON.parse(localStorage.getItem("ekoakort_user")||"{}"),t=parseInt(H.subscription_id),s=parseFloat(H.counter_value),a=D.find(e=>e.id===t);if(!a)throw Error("Abonelik bulunamadƒ±");if(null!==O&&s<O)return void alert(`‚ùå Hatalƒ± giri≈ü!

Saya\xe7 geriye gidemez!

Son saya\xe7 deƒüeri: ${O}
Girdiƒüiniz deƒüer: ${s}

L\xfctfen son deƒüerden B\xdcY\xdcK veya E≈ûƒ∞T bir sayƒ± girin.`);let r=new Date,i={user_id:e.id,subscription_id:t,month:r.getMonth()+1,year:r.getFullYear(),created_at:r.toISOString(),monthly_points:10};"water"===a.utility_type?(i.water_amount=s,i.electricity_amount=0):(i.electricity_amount=s,i.water_amount=0);let{error:n}=await A.supabase.from("consumptions").insert([i]);if(n)throw n;let l=a.companies?.[0],c="water"===a.utility_type?"Su":"Elektrik",d="water"===a.utility_type?"m¬≥":"kWh",o=`‚úÖ ${c} saya\xe7 kaydƒ± ba≈üarƒ±lƒ±!

`;if(o+=`≈ûirket: ${l?.name||"Bilinmeyen"}
Yeni saya\xe7 deƒüeri: ${s} ${d}
`,null!==O){let e=s-O;o+=`\xd6nceki saya\xe7: ${O} ${d}
Bu d\xf6nem t\xfcketimi: ${e.toFixed(2)} ${d}
`}o+=`
Kazanƒ±lan puan: 10
`,alert(o),q({subscription_id:H.subscription_id,counter_value:""}),F(s),W(new Date().toLocaleDateString("tr-TR")),eb()}catch(e){console.error("Kayƒ±t hatasƒ±:",e),alert("Kayƒ±t eklenirken hata: "+e.message)}},eb=()=>{ep()};return((0,s.useEffect)(()=>{let t;(t=localStorage.getItem("ekoakort_user"))?M(JSON.parse(t)):e.push("/login"),ep();let s=e=>{e.ctrlKey&&"r"===e.key&&(e.preventDefault(),eb())};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[]),(0,s.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("ekoakort_user")||"{}");e.id&&eh(e.id)},[]),(0,s.useEffect)(()=>{H.subscription_id?ed(parseInt(H.subscription_id)):(F(null),W(null))},[H.subscription_id,D]),T)?(0,t.jsx)(z.default,{message:"Dashboard y√ºkleniyor..."}):(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-100 border border-green-200 rounded-2xl p-6 mb-8",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-gray-800",children:["Ho≈ü Geldiniz, ",l?.name||"Deƒüerli Kullanƒ±cƒ±","! üëã"]}),(0,t.jsx)("button",{onClick:eb,disabled:$,className:"ml-3 p-2 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-lg transition",title:"Yenile (Ctrl+R)",children:(0,t.jsx)(k.RefreshCw,{className:`w-5 h-5 ${$?"animate-spin":""}`})})]}),(0,t.jsxs)("p",{className:"text-gray-600",children:[(0,t.jsx)(p.Building,{className:"w-4 h-4 inline mr-1"}),l?.apartment?.building?.name||"Apartmanƒ±nƒ±z",", Daire"," ",l?.apartment?.number,(0,t.jsx)("span",{className:"mx-2",children:"‚Ä¢"}),(0,t.jsx)(y.Home,{className:"w-4 h-4 inline mr-1"}),l?.family_size||1," ki≈üilik aile"]}),es.currentMonthName&&(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:[(0,t.jsx)(d,{className:"w-3 h-3 inline mr-1"}),es.currentMonthName," verileriniz g√∂steriliyor"]})]}),(0,t.jsx)("div",{className:"mt-4 md:mt-0",children:(0,t.jsxs)("div",{className:"inline-flex items-center bg-white px-4 py-3 rounded-lg shadow",children:[(0,t.jsx)(m.Award,{className:"w-6 h-6 text-yellow-500 mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Bu Ayki Puan"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:[es.monthlyPoints,(0,t.jsxs)("span",{className:"text-sm text-gray-400 ml-2",children:["/ ",es.totalPoints," toplam"]})]})]})]})})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow border hover:shadow-md transition",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:`p-3 rounded-lg ${es.waterSavingsPercent>0?"bg-blue-100":es.waterSavingsPercent<0?"bg-red-100":"bg-gray-100"}`,children:(0,t.jsx)(r.Droplets,{className:`w-6 h-6 ${es.waterSavingsPercent>0?"text-blue-600":es.waterSavingsPercent<0?"text-red-600":"text-gray-600"}`})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:[es.waterSavingsPercent>0?"+":"",es.waterSavingsPercent,"%"]}),(0,t.jsx)("div",{className:"text-gray-500 text-sm",children:es.waterSavingsPercent>0?"Su Tasarrufu":es.waterSavingsPercent<0?"Fazla T√ºketim":"Deƒüi≈üim Yok"})]})]}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[es.currentMonthName,":"]}),(0,t.jsxs)("span",{className:"font-semibold",children:[es.currentMonthWater," m¬≥"]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[es.previousMonthName,":"]}),(0,t.jsxs)("span",{className:"font-medium",children:[es.previousMonthWater," m¬≥"]})]}),0!==es.waterSavedAmount&&(0,t.jsxs)("div",{className:`mt-2 text-sm font-medium ${es.waterSavedAmount>0?"text-green-600":"text-red-600"}`,children:[es.waterSavedAmount>0?"‚úì":"‚ö†Ô∏è",Math.abs(es.waterSavedAmount).toFixed(1)," m¬≥"," ",es.waterSavedAmount>0?"tasarruf":"fazla"]})]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow border hover:shadow-md transition",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:`p-3 rounded-lg ${es.electricitySavingsPercent>0?"bg-yellow-100":es.electricitySavingsPercent<0?"bg-red-100":"bg-gray-100"}`,children:(0,t.jsx)(i.Zap,{className:`w-6 h-6 ${es.electricitySavingsPercent>0?"text-yellow-600":es.electricitySavingsPercent<0?"text-red-600":"text-gray-600"}`})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:[es.electricitySavingsPercent>0?"+":"",es.electricitySavingsPercent,"%"]}),(0,t.jsx)("div",{className:"text-gray-500 text-sm",children:es.electricitySavingsPercent>0?"Elektrik Tasarrufu":es.electricitySavingsPercent<0?"Fazla T√ºketim":"Deƒüi≈üim Yok"})]})]}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[es.currentMonthName,":"]}),(0,t.jsxs)("span",{className:"font-semibold",children:[es.currentMonthElectricity," kWh"]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[es.previousMonthName,":"]}),(0,t.jsxs)("span",{className:"font-medium",children:[es.previousMonthElectricity," kWh"]})]}),0!==es.electricitySavedAmount&&(0,t.jsxs)("div",{className:`mt-2 text-sm font-medium ${es.electricitySavedAmount>0?"text-green-600":"text-red-600"}`,children:[es.electricitySavedAmount>0?"‚úì":"‚ö†Ô∏è",Math.abs(es.electricitySavedAmount).toFixed(1)," kWh"," ",es.electricitySavedAmount>0?"tasarruf":"fazla"]})]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow border hover:shadow-md transition",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"p-3 rounded-lg bg-purple-100",children:(0,t.jsx)(n.Trophy,{className:"w-6 h-6 text-purple-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["#",es.monthlyRank||"-"]}),(0,t.jsx)("div",{className:"text-gray-500 text-sm",children:"Bu Ayki Sƒ±ralama"})]})]}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Apartmanda:"}),(0,t.jsxs)("span",{className:"font-semibold",children:[es.totalInBuilding," daire"]})]}),(0,t.jsx)("div",{className:"text-purple-600 mt-1",children:1===es.monthlyRank?"üèÜ Bu Ayƒ±n ≈ûampiyonu!":es.monthlyRank<=3?"üî• ƒ∞lk √º√ßte!":es.monthlyRank<=10?"üí™ ƒ∞yi gidiyorsun!":"üìà Devam edin!"})]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow border hover:shadow-md transition",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:`p-3 rounded-lg ${es.comparedToAvg.includes("s√ºper")?"bg-green-100":es.comparedToAvg.includes("harika")?"bg-blue-100":es.comparedToAvg.includes("dikkat")?"bg-red-100":"bg-gray-100"}`,children:es.comparedToAvg.includes("s√ºper")||es.comparedToAvg.includes("harika")?(0,t.jsx)(N.TrendingUp,{className:"w-6 h-6 text-green-600"}):es.comparedToAvg.includes("dikkat")?(0,t.jsx)(c,{className:"w-6 h-6 text-red-600"}):(0,t.jsx)(w.BarChart3,{className:"w-6 h-6 text-gray-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("div",{className:`text-2xl font-bold ${es.comparedToAvg.includes("s√ºper")?"text-green-600":es.comparedToAvg.includes("harika")?"text-blue-600":es.comparedToAvg.includes("dikkat")?"text-red-600":"text-gray-600"}`,children:es.comparedToAvg.includes("s√ºper")?"S√úPER":es.comparedToAvg.includes("harika")?"ƒ∞Yƒ∞":es.comparedToAvg.includes("dikkat")?"Dƒ∞KKAT":"ORTA"}),(0,t.jsx)("div",{className:"text-gray-500 text-sm",children:"Durumunuz"})]})]}),(0,t.jsx)("div",{className:"text-sm",children:(0,t.jsx)("div",{className:`font-medium ${es.comparedToAvg.includes("s√ºper")?"text-green-600":es.comparedToAvg.includes("harika")?"text-blue-600":es.comparedToAvg.includes("dikkat")?"text-red-600":"text-gray-600"}`,children:es.comparedToAvg})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow border p-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,t.jsx)(o.PlusCircle,{className:"w-5 h-5 mr-2 text-green-600"}),"Hƒ±zlƒ± Saya√ß Kaydƒ±"]}),0===D.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(g.AlertCircle,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-700 mb-3",children:"Hen√ºz aboneliƒüiniz bulunmuyor."}),(0,t.jsx)("button",{onClick:()=>e.push("/profile"),className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:opacity-90 transition",children:"üìù Profile Git ve Abonelik Ekle"})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Abonelik Se√ßin *"}),(0,t.jsxs)("select",{value:H.subscription_id,onChange:e=>{let t=e.target.value;q({...H,subscription_id:t}),I(D.find(e=>e.id===parseInt(t))||null),t&&ed(parseInt(t))},className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"",children:"Aboneliƒüinizi se√ßin"}),D.map(e=>{let s=e.companies?.[0],a=s?.is_contracted;return(0,t.jsxs)("option",{value:e.id,children:["water"===e.utility_type?"üíß":"‚ö°",s?.name||"Bilinmeyen ≈ûirket",a&&" ü§ù","(",s?.code||"???",") -"," ",e.subscriber_no]},e.id)})]}),null!==O&&B&&(0,t.jsxs)("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center text-sm text-blue-800",children:[(0,t.jsx)("div",{className:"bg-blue-100 p-1.5 rounded-lg mr-2",children:(0,t.jsx)(f.History,{className:"w-4 h-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Son saya√ß deƒüeri: "}),(0,t.jsx)("span",{className:"font-bold",children:O}),(0,t.jsx)("span",{className:"ml-1",children:"water"===B.utility_type?"m¬≥":"kWh"}),L&&(0,t.jsxs)("span",{className:"ml-2 text-blue-600",children:["(",L,")"]})]})]}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-blue-600 space-y-1",children:[(0,t.jsxs)("div",{children:["üìä"," ",(0,t.jsx)("strong",{children:"Saya√ß √ºzerindeki son okuduƒüunuz deƒüeri girin"})]}),(0,t.jsx)("div",{children:"üìà Sistem otomatik olarak t√ºketiminizi hesaplayacak"}),(0,t.jsxs)("div",{className:"font-medium text-blue-700",children:["√ñrnek: Son deƒüer ",O," ise,"," ",O+5," girebilirsiniz"]})]})]}),!O&&H.subscription_id&&(0,t.jsx)("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center text-sm text-yellow-800",children:[(0,t.jsx)("div",{className:"bg-yellow-100 p-1.5 rounded-lg mr-2",children:(0,t.jsx)(j,{className:"w-4 h-4"})}),(0,t.jsx)("div",{children:"Bu abonelik i√ßin hen√ºz kayƒ±t bulunmuyor. ƒ∞lk saya√ß deƒüerinizi girin."})]})}),B&&(0,t.jsx)("div",{className:"mt-2 text-sm",children:(0,t.jsx)("div",{className:"flex items-center text-gray-600",children:B.companies?.[0]?.is_contracted?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S,{className:"w-4 h-4 text-green-600 mr-1"}),(0,t.jsx)("span",{className:"text-green-600 font-medium",children:"S√∂zle≈ümeli firma"}),(0,t.jsx)("span",{className:"mx-2",children:"‚Ä¢"}),(0,t.jsx)("span",{children:"Otomatik veri entegrasyonu aktif"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.AlertCircle,{className:"w-4 h-4 text-yellow-600 mr-1"}),(0,t.jsx)("span",{className:"text-yellow-600",children:"Manuel kayƒ±t gerekiyor"})]})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Yeni Saya√ß Deƒüeri *",null!==O&&(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(Son: ",O,")"]})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"number",step:"0.01",value:H.counter_value,onChange:e=>{let t=e.target.value;null!==O&&parseFloat(t)<=O?e.target.classList.add("border-red-500"):e.target.classList.remove("border-red-500"),q({...H,counter_value:t})},className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent pl-12",placeholder:B?.utility_type==="water"?null!==O?`\xd6rn: ${O+5}`:"1250.50 (m¬≥)":null!==O?`\xd6rn: ${O+50}`:"4500.75 (kWh)",required:!0,min:null!==O?O+.01:void 0}),(0,t.jsx)("div",{className:"absolute left-3 top-3.5",children:B?.utility_type==="water"?(0,t.jsx)(r.Droplets,{className:"w-5 h-5 text-blue-500"}):(0,t.jsx)(i.Zap,{className:"w-5 h-5 text-yellow-500"})})]}),null!==O&&H.counter_value&&parseFloat(H.counter_value)<=O&&(0,t.jsxs)("div",{className:"mt-2 text-sm text-red-600 flex items-center",children:[(0,t.jsx)(g.AlertCircle,{className:"w-4 h-4 mr-1"}),"Girdiƒüiniz deƒüer son deƒüerden (",O,") k√º√ß√ºk veya e≈üit!"]})]}),(0,t.jsxs)("button",{onClick:eg,disabled:!H.subscription_id||!H.counter_value||null!==O&&parseFloat(H.counter_value)<=O,className:"w-full py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center",children:[(0,t.jsx)(o.PlusCircle,{className:"w-5 h-5 mr-2"}),"Kaydƒ± Ekle (+10 puan)"]}),(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)(f.History,{className:"w-5 h-5 text-blue-500 mr-3 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-blue-700 mb-1",children:"üìÖ Aylƒ±k Kayƒ±t Hatƒ±rlatƒ±cƒ±sƒ±"}),(0,t.jsxs)("p",{className:"text-xs text-blue-600",children:["Her ay ",(0,t.jsx)("strong",{children:"aynƒ± g√ºn"})," saya√ß okumanƒ±zƒ± yapƒ±n. B√∂ylece tasarrufunuzu doƒüru hesaplayabilir ve maksimum puan kazanƒ±rsƒ±nƒ±z."]})]})]})})]})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,t.jsx)(w.BarChart3,{className:"w-5 h-5 mr-2 text-blue-600"}),"Son Kayƒ±tlarƒ±nƒ±z ve ƒ∞statistikler"]}),0===K.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(f.History,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,t.jsx)("p",{className:"text-gray-600 mb-2",children:"Hen√ºz kayƒ±t yapƒ±lmamƒ±≈ü"}),(0,t.jsx)("p",{className:"text-sm",children:"ƒ∞lk saya√ß kaydƒ±nƒ±zƒ± yukarƒ±dan ekleyin"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("h4",{className:"font-medium text-gray-700 mb-3 flex items-center",children:[(0,t.jsx)(_,{className:"w-4 h-4 mr-2"}),"Son 5 Kaydƒ±nƒ±z"]}),(0,t.jsx)("div",{className:"space-y-3",children:K.slice(0,5).map(e=>{let s=D.find(t=>t.id===e.subscription_id),a=s?.companies?.[0],n=s?.utility_type;return(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,t.jsxs)("div",{className:"flex items-center",children:["water"===n?(0,t.jsx)(r.Droplets,{className:"w-4 h-4 text-blue-500 mr-2"}):(0,t.jsx)(i.Zap,{className:"w-4 h-4 text-yellow-500 mr-2"}),(0,t.jsx)("span",{className:"font-medium text-gray-800",children:a?.name||("water"===n?"Su":"Elektrik")})]}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString("tr-TR")})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:["water"===n?"Su:":"Elektrik:",(0,t.jsx)("span",{className:"font-semibold ml-1",children:"water"===n?`${e.water_amount?.toFixed(2)} m\xb3`:`${e.electricity_amount?.toFixed(2)} kWh`})]}),(0,t.jsxs)("span",{className:"text-green-600 font-medium",children:["+",e.monthly_points||0," puan"]})]})]},e.id)})})]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"üìà T√ºketim √ñzeti"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:es.currentMonthWater.toFixed(1)}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Bu Ay Su (m¬≥)"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:es.currentMonthElectricity.toFixed(1)}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Bu Ay Elektrik (kWh)"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:es.monthlyPoints}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Bu Ayki Puan"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:K.length}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Toplam Kayƒ±t"})]})]})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow border p-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,t.jsx)(b.CreditCard,{className:"w-5 h-5 mr-2 text-green-600"}),"Bu Ayki ƒ∞ndirimleriniz"]}),0===Z.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(b.CreditCard,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,t.jsx)("p",{children:"Hen√ºz indiriminiz yok."}),(0,t.jsx)("p",{className:"text-sm mt-1",children:"Tasarruf yaparak puan kazanƒ±n!"})]}):(0,t.jsx)("div",{className:"space-y-4",children:Z.map(e=>(0,t.jsxs)("div",{className:`border rounded-lg p-4 ${e.current_discount>0?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50"}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:`p-2 rounded-lg mr-3 ${"water"===e.utility_type?"bg-blue-100":"bg-yellow-100"}`,children:"water"===e.utility_type?(0,t.jsx)(r.Droplets,{className:"w-5 h-5 text-blue-600"}):(0,t.jsx)(i.Zap,{className:"w-5 h-5 text-yellow-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-bold text-gray-800",children:[e.company_name,e.is_contracted&&(0,t.jsx)("span",{className:"ml-2 text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:"ü§ù S√∂zle≈ümeli"})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["water"===e.utility_type?"üíß Su":"‚ö° Elektrik",(0,t.jsx)("button",{onClick:()=>et(e.company_id),className:"ml-2 text-gray-400 hover:text-gray-600",title:"ƒ∞ndirim tablosunu g√∂r",children:(0,t.jsx)(j,{className:"w-4 h-4 inline"})})]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:`text-2xl font-bold ${e.current_discount>0?"text-green-600":"text-gray-400"}`,children:["%",e.current_discount]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"indirim"})]})]}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[e.current_tier_name,(0,t.jsxs)("span",{className:"ml-2 text-gray-400",children:["(",e.monthly_points," puan)"]})]}),(0,t.jsxs)("span",{className:"font-medium",children:["Toplam: ",e.total_points," puan"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:`h-2 rounded-full transition-all ${e.progress_percent>50?"bg-green-500":"bg-yellow-500"}`,style:{width:`${e.progress_percent}%`}})})]}),e.next_tier_points>0&&(0,t.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Sonraki seviye i√ßin:"}),(0,t.jsxs)("span",{className:"text-sm font-semibold text-green-700",children:["+",e.next_tier_points," puan ‚Üí %",e.next_tier_discount]})]})})]},e.company_id))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow border p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[(0,t.jsx)(u.Lightbulb,{className:"w-5 h-5 mr-2 text-yellow-500"}),"Size √ñzel √ñneriler",(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(Aylƒ±k limit: ",3-(l?.monthly_tips_used||0),"/",3," kaldƒ±)"]})]}),(0,t.jsxs)("button",{onClick:()=>e.push("/tips"),className:"text-sm text-green-600 hover:text-green-700 flex items-center",children:["T√ºm√ºn√º G√∂r ",(0,t.jsx)(h,{className:"w-4 h-4 ml-1"})]})]}),0===Y.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(u.Lightbulb,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,t.jsx)("p",{children:"T√ºm √∂nerileri uyguladƒ±nƒ±z!"}),(0,t.jsx)("p",{className:"text-sm mt-1",children:"Gelecek ay yeni √∂neriler gelecek."})]}):(0,t.jsx)("div",{className:"space-y-4",children:Y.slice(0,3).map(e=>{let s=3-(l?.monthly_tips_used||0),a=e.points_reward||10;return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-green-300 transition",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${"water"===e.utility_type?"bg-blue-100 text-blue-700":"electricity"===e.utility_type?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:"water"===e.utility_type?"üíß SU":"electricity"===e.utility_type?"‚ö° ELEKTRƒ∞K":"üåç GENEL"}),(0,t.jsx)("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${"easy"===e.difficulty?"bg-green-100 text-green-700":"medium"===e.difficulty?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:"easy"===e.difficulty?"Kolay":"medium"===e.difficulty?"Orta":"Zor"})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("span",{className:"text-sm font-semibold text-green-600 mr-2",children:["%",e.estimated_savings||5," tasarruf"]}),(0,t.jsxs)("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full",children:["+",a," puan"]})]})})]}),(0,t.jsx)("h3",{className:"font-semibold text-gray-800 mb-1",children:e.title}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:e.content}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500",children:s>0?`‚è≥ ${s} \xf6neri hakkƒ±nƒ±z kaldƒ±`:"‚ùå Aylƒ±k limit doldu"}),(0,t.jsx)("button",{onClick:()=>ey(e.id),disabled:s<=0,className:`px-3 py-1.5 text-sm rounded-lg font-medium transition ${s>0?"bg-green-500 text-white hover:bg-green-600":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:s>0?"Uygula":"Limit Doldu"})]})]},e.id)})}),(0,t.jsx)("div",{className:"mt-6 pt-6 border-t",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-gray-800 mb-1",children:"üìä Aylƒ±k √ñneri Durumu"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Bu ay ",l?.monthly_tips_used||0,"/3 √∂neri uyguladƒ±nƒ±z"]})]}),(0,t.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-3",children:(0,t.jsx)("div",{className:"bg-green-500 h-3 rounded-full transition-all",style:{width:`${(l?.monthly_tips_used||0)/3*100}%`}})})]})})]})]}),(0,t.jsx)("div",{className:"mt-8",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow border p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[(0,t.jsx)(n.Trophy,{className:"w-5 h-5 mr-2 text-purple-500"}),"Apartman Aylƒ±k Liderliƒüi"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:[es.currentMonthName," ‚Ä¢ ",J.length," aktif kullanƒ±cƒ±"]})]}),0===J.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(x.Users,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,t.jsx)("p",{children:"Hen√ºz liderlik verisi yok."}),(0,t.jsx)("p",{className:"text-sm mt-1",children:"Kom≈üularƒ±nƒ±z kayƒ±t yaptƒ±k√ßa g√∂r√ºnecek"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full min-w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 text-gray-500 font-medium",children:"Sƒ±ra"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-gray-500 font-medium",children:"Kullanƒ±cƒ±"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-gray-500 font-medium",children:"Bu Ayki Puan"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-gray-500 font-medium",children:"Toplam Puan"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-gray-500 font-medium",children:"Daire"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-gray-500 font-medium",children:"Durum"})]})}),(0,t.jsx)("tbody",{children:J.map((e,s)=>(0,t.jsxs)("tr",{className:`border-b hover:bg-gray-50 ${e.is_current_user?"bg-green-50":""}`,children:[(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-medium ${0===s?"bg-yellow-100 text-yellow-700":1===s?"bg-gray-100 text-gray-700":2===s?"bg-orange-100 text-orange-700":"bg-gray-50 text-gray-600"}`,children:0===s?"ü•á":1===s?"ü•à":2===s?"ü•â":s+1})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-100 to-green-100 rounded-full flex items-center justify-center text-lg mr-3",children:e.name.charAt(0)}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"font-medium text-gray-800",children:[e.name,e.is_current_user&&(0,t.jsx)("span",{className:"ml-2 text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Siz"})]})})]})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("div",{className:"font-bold text-gray-800",children:e.monthly_points})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("div",{className:"font-semibold text-gray-700",children:e.total_points})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("div",{className:"text-gray-600",children:["Daire ",e.apartment_number]})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:`px-3 py-1.5 rounded-full text-xs font-medium ${e.monthly_points>150?"bg-green-100 text-green-700":e.monthly_points>100?"bg-blue-100 text-blue-700":e.monthly_points>50?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:e.monthly_points>150?"S√ºper":e.monthly_points>100?"ƒ∞yi":e.monthly_points>50?"Orta":"Ba≈ülangƒ±√ß"})})]},e.id))})]})}),es.monthlyRank>0&&(0,t.jsx)("div",{className:"mt-6 pt-6 border-t",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-gray-700 font-medium",children:["Sƒ±ralamanƒ±z:"," ",(0,t.jsxs)("span",{className:"font-bold",children:["#",es.monthlyRank]})]}),es.monthlyRank>1&&J[es.monthlyRank-2]&&(0,t.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Bir √ºst sƒ±ra i√ßin:"," ",(0,t.jsxs)("span",{className:"font-semibold text-green-600",children:["+",J[es.monthlyRank-2].monthly_points-es.monthlyPoints," ","puan"]})]})]}),(0,t.jsx)("div",{className:"mt-4 md:mt-0",children:(0,t.jsxs)("button",{onClick:()=>e.push("/leaderboard"),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition flex items-center",children:[(0,t.jsx)(n.Trophy,{className:"w-4 h-4 mr-2"}),"Tam Liderlik Tablosu"]})})]})})]})]})}),(0,t.jsxs)("div",{className:"mt-8 bg-gradient-to-r from-green-50 to-emerald-100 border border-green-200 rounded-xl p-6",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,t.jsx)(v.Sparkles,{className:"w-6 h-6 mr-3 text-green-600"}),"ƒ∞pu√ßlarƒ± ve Hatƒ±rlatmalar"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-green-200",children:[(0,t.jsx)("div",{className:"font-medium text-gray-800 mb-2",children:"üìÖ Aylƒ±k Hatƒ±rlatƒ±cƒ±"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Her ay aynƒ± g√ºn saya√ß okumanƒ±zƒ± yapƒ±n. D√ºzenlilik bonusu kazanƒ±rsƒ±nƒ±z."})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-green-200",children:[(0,t.jsx)("div",{className:"font-medium text-gray-800 mb-2",children:"üèÜ ƒ∞ndirim Kazanma"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["ƒ∞ndirimler ",(0,t.jsx)("strong",{children:"bu ayki puanƒ±nƒ±za"})," g√∂re belirlenir. Her ay yeniden kazanmanƒ±z gerekir."]})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-green-200",children:[(0,t.jsx)("div",{className:"font-medium text-gray-800 mb-2",children:"ü§ù S√∂zle≈ümeli Firmalar"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"ƒ∞SKƒ∞, Aydem gibi s√∂zle≈ümeli firmalar otomatik veri aktarƒ±mƒ± saƒülar. Profilden ekleyebilirsiniz."})]})]})]}),(0,t.jsx)("div",{className:"mt-8 text-center text-xs text-gray-500",children:(0,t.jsxs)("p",{children:["Eko-Akort | Tasarrufunuzu takip edin, puan kazanƒ±n, indirimlerden faydalanƒ±n! üíö",(0,t.jsxs)("span",{className:"ml-2",children:["Son g√ºncelleme: ",new Date().toLocaleTimeString("tr-TR")]})]})}),ee&&(0,t.jsx)(({companyDiscount:e,onClose:s})=>(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold text-gray-800",children:[e.company_name," ƒ∞ndirim Tablosu"]}),(0,t.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:"‚úï"})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Bu Ayki Puan:"}),(0,t.jsxs)("span",{className:"font-bold text-green-600",children:[e.monthly_points," puan"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Mevcut ƒ∞ndirim:"}),(0,t.jsxs)("span",{className:"text-2xl font-bold text-green-700",children:["%",e.current_discount]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Toplam Puan:"}),(0,t.jsx)("span",{className:"font-semibold",children:e.total_points})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-2",children:(0,t.jsx)("div",{className:"bg-green-500 h-3 rounded-full transition-all",style:{width:`${e.progress_percent}%`}})}),(0,t.jsxs)("div",{className:"text-right text-sm text-gray-500",children:["%",e.progress_percent," tamamlandƒ±"]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-bold text-gray-800 mb-2",children:"ƒ∞ndirim Seviyeleri:"}),e.discount_tiers.map((s,a)=>(0,t.jsxs)("div",{className:`p-3 rounded-lg border ${e.current_discount>=s.discount_percent?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-800",children:s.tier_name||`Seviye ${a+1}`}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:[s.min_points," puan/gerekiyor"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-lg font-bold text-green-600",children:["%",s.discount_percent]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"indirim"})]})]}),e.current_discount===s.discount_percent&&(0,t.jsxs)("div",{className:"mt-2 text-xs text-green-600 flex items-center",children:[(0,t.jsx)(v.Sparkles,{className:"w-3 h-3 mr-1"})," Mevcut seviyeniz"]})]},a))]}),(0,t.jsx)("div",{className:"mt-6 pt-4 border-t",children:(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,t.jsx)("span",{children:"Bu ayki puan:"}),(0,t.jsx)("span",{className:"font-medium",children:e.monthly_points})]}),e.next_tier_points>0&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Sonraki seviye i√ßin:"}),(0,t.jsxs)("span",{className:"font-medium text-green-600",children:["+",e.next_tier_points," puan (%",e.next_tier_discount,")"]})]})]})}),(0,t.jsx)("button",{onClick:s,className:"mt-6 w-full py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition",children:"Kapat"})]})}),{companyDiscount:Z.find(e=>e.company_id===ee),onClose:()=>et(null)})]})}e.s(["default",()=>M],78928)}]);